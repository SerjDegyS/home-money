{"ast":null,"code":"import { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { Message } from '../../shared/models/message.model';\nimport { fadeStateTrigger } from '../../shared/animations/fade.animation';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../shared/services/users.service\";\nimport * as i2 from \"../../shared/services/auth.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/platform-browser\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/forms\";\nfunction LoginComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵclassMapInterpolate1(\"alert alert-\", ctx_r0.message.type, \"\");\n    i0.ɵɵproperty(\"@fade\", undefined);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.message.text, \"\\n\");\n  }\n}\nfunction LoginComponent_span_8_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Email \\u043D\\u0435 \\u043C\\u043E\\u0436\\u0435\\u0442 \\u0431\\u044B\\u0442\\u044C \\u043F\\u0443\\u0441\\u0442\\u044B\\u043C.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_span_8_span_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"\\u0412\\u0432\\u0435\\u0438\\u0442\\u0435 \\u043A\\u043E\\u0440\\u0435\\u043A\\u0442\\u043D\\u044B\\u0439 email.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_span_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 14);\n    i0.ɵɵtemplate(1, LoginComponent_span_8_span_1_Template, 2, 0, \"span\", 15);\n    i0.ɵɵtemplate(2, LoginComponent_span_8_span_2_Template, 2, 0, \"span\", 15);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.form.get(\"email\")[\"errors\"][\"required\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.form.get(\"email\")[\"errors\"][\"email\"]);\n  }\n}\nfunction LoginComponent_span_13_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C \\u043D\\u0435 \\u043C\\u043E\\u0436\\u0435\\u0442 \\u0431\\u044B\\u0442\\u044C \\u043F\\u0443\\u0441\\u0442\\u044B\\u043C.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_span_13_span_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \\u041F\\u0430\\u0440\\u043E\\u043B\\u044C \\u043E\\u043B\\u0436\\u0435\\u043D \\u0431\\u044B\\u0442\\u044C \\u0431\\u043E\\u043B\\u044C\\u0448\\u0435 \", ctx_r6.form.get(\"password\")[\"errors\"][\"minlength\"][\"requiredLength\"], \" \\u0441\\u0438\\u043C\\u0432\\u043E\\u043B\\u043E\\u0432. \\u0421\\u0435\\u0439\\u0447\\u0430\\u0441 \", ctx_r6.form.get(\"password\")[\"errors\"][\"minlength\"][\"actualLength\"], \". \");\n  }\n}\nfunction LoginComponent_span_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 14);\n    i0.ɵɵtemplate(1, LoginComponent_span_13_span_1_Template, 2, 0, \"span\", 15);\n    i0.ɵɵtemplate(2, LoginComponent_span_13_span_2_Template, 2, 2, \"span\", 15);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.form.get(\"password\")[\"errors\"][\"required\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.form.get(\"password\")[\"errors\"][\"minlength\"] && ctx_r2.form.get(\"password\")[\"errors\"][\"minlength\"][\"requiredLength\"]);\n  }\n}\nconst _c0 = function (a0) {\n  return {\n    \"has-error\": a0\n  };\n};\nexport let LoginComponent = /*#__PURE__*/(() => {\n  class LoginComponent {\n    constructor(usersService, authService, router, route, title, meta) {\n      this.usersService = usersService;\n      this.authService = authService;\n      this.router = router;\n      this.route = route;\n      this.title = title;\n      this.meta = meta;\n      this.message = new Message();\n      title.setTitle('Вход в систему');\n    }\n    ngOnInit() {\n      this.form = new FormGroup({\n        ['email']: new FormControl(null, [Validators.required, Validators.email]),\n        ['password']: new FormControl(null, [Validators.required, Validators.minLength(6)])\n      });\n      this.route.queryParams.subscribe(params => {\n        if (params['nowCanlogin']) {\n          this.message.showMessage('success', 'Теперь Вы можете войти.');\n        } else if (params['accessDenied']) {\n          this.message.showMessage('warning', 'Для работи с системой вам нужно войти');\n        } else if (params['asVisitor']) {\n          const dataVisitor = {\n            email: 'visitor@mail.ru',\n            password: '12345678'\n          };\n          this.form.setValue(dataVisitor);\n        }\n      });\n    }\n    onSubmit() {\n      const formData = this.form.value;\n      console.log(formData.email);\n      this.usersService.getUserByEmail(formData.email).subscribe(user => {\n        if (user) {\n          if (user.password === formData.password) {\n            window.localStorage.setItem('user', JSON.stringify(user));\n            this.authService.login();\n            this.router.navigate(['/system', 'bill']);\n          } else {\n            this.message.showMessage('danger', 'Пароль не верный');\n          }\n        } else {\n          this.message.showMessage('danger', 'Пользователь не существует');\n        }\n      });\n    }\n    OnCancel() {\n      this.router.navigate(['']);\n    }\n  }\n  LoginComponent.ɵfac = function LoginComponent_Factory(t) {\n    return new (t || LoginComponent)(i0.ɵɵdirectiveInject(i1.UsersService), i0.ɵɵdirectiveInject(i2.AuthService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i3.ActivatedRoute), i0.ɵɵdirectiveInject(i4.Title), i0.ɵɵdirectiveInject(i4.Meta));\n  };\n  LoginComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: LoginComponent,\n    selectors: [[\"degys-login\"]],\n    decls: 24,\n    vars: 12,\n    consts: [[1, \"text-xs-center\"], [3, \"class\", 4, \"ngIf\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"form-group\", 3, \"ngClass\"], [\"for\", \"email\"], [\"type\", \"text\", \"id\", \"email\", \"placeholder\", \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0432\\u0430\\u0448 email\", \"formControlName\", \"email\", 1, \"form-control\", \"underlined\"], [\"class\", \"form-help-text\", 4, \"ngIf\"], [\"for\", \"password\"], [\"type\", \"password\", \"id\", \"password\", \"placeholder\", \"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\", \"formControlName\", \"password\", 1, \"form-control\", \"underlined\"], [1, \"form-group\"], [\"type\", \"submit\", 1, \"btn\", \"btn-block\", \"btn-primary\", 3, \"disabled\"], [1, \"btn\", \"btn-block\", \"btn-warning\", 3, \"click\"], [1, \"text-muted\", \"text-xs-center\"], [3, \"routerLink\"], [1, \"form-help-text\"], [4, \"ngIf\"]],\n    template: function LoginComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"p\", 0);\n        i0.ɵɵtext(1, \"\\u0412\\u043E\\u0439\\u0434\\u0438\\u0442\\u0435 \\u0434\\u043B\\u044F \\u0440\\u0430\\u0431\\u043E\\u0442\\u044B\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(2, LoginComponent_div_2_Template, 2, 5, \"div\", 1);\n        i0.ɵɵelementStart(3, \"form\", 2);\n        i0.ɵɵlistener(\"ngSubmit\", function LoginComponent_Template_form_ngSubmit_3_listener() {\n          return ctx.onSubmit();\n        });\n        i0.ɵɵelementStart(4, \"div\", 3)(5, \"label\", 4);\n        i0.ɵɵtext(6, \"Email\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(7, \"input\", 5);\n        i0.ɵɵtemplate(8, LoginComponent_span_8_Template, 3, 2, \"span\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"div\", 3)(10, \"label\", 7);\n        i0.ɵɵtext(11, \"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(12, \"input\", 8);\n        i0.ɵɵtemplate(13, LoginComponent_span_13_Template, 3, 2, \"span\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"div\", 9)(15, \"button\", 10);\n        i0.ɵɵtext(16, \" \\u0412\\u043E\\u0439\\u0442\\u0438 \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(17, \"div\", 11);\n        i0.ɵɵlistener(\"click\", function LoginComponent_Template_div_click_17_listener() {\n          return ctx.OnCancel();\n        });\n        i0.ɵɵtext(18, \" \\u041E\\u0442\\u043C\\u0435\\u043D\\u0430 \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"div\", 9)(20, \"p\", 12);\n        i0.ɵɵtext(21, \" \\u041D\\u0435\\u0442 \\u0430\\u043A\\u043A\\u0430\\u0443\\u043D\\u0442\\u0430? \");\n        i0.ɵɵelementStart(22, \"a\", 13);\n        i0.ɵɵtext(23, \"\\u0417\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F!\");\n        i0.ɵɵelementEnd()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.message.text);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"formGroup\", ctx.form);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(8, _c0, ctx.form.get(\"email\").invalid && ctx.form.get(\"email\").touched));\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngIf\", ctx.form.get(\"email\").invalid && ctx.form.get(\"email\").touched);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(10, _c0, ctx.form.get(\"password\").invalid && ctx.form.get(\"password\").touched));\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngIf\", ctx.form.get(\"password\").invalid && ctx.form.get(\"password\").touched);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"disabled\", ctx.form.invalid);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"routerLink\", \"/auth/registration\");\n      }\n    },\n    dependencies: [i5.NgClass, i5.NgIf, i3.RouterLink, i6.ɵNgNoValidate, i6.DefaultValueAccessor, i6.NgControlStatus, i6.NgControlStatusGroup, i6.FormGroupDirective, i6.FormControlName],\n    data: {\n      animation: [fadeStateTrigger]\n    }\n  });\n  return LoginComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}